{% extends "base.html" %}

{% block title %}Aprobar Solicitudes{% endblock %}

{% block content %}
<h1 class="mb-4"><i class="bi bi-check-circle"></i> Solicitudes Pendientes</h1>

<div class="card mb-4">
    <div class="card-header bg-success text-white">
        <h5 class="mb-0"><i class="bi bi-calendar-check"></i> Vacaciones</h5>
    </div>
    <div class="card-body">
        {% if solicitudes_vac %}
        <div class="table-responsive">
            <table class="table table-hover">
                <thead>
                    <tr>
                        <th>Empleado</th>
                        <th>Desde</th>
                        <th>Hasta</th>
                        <th>Días</th>
                        <th>Acciones</th>
                    </tr>
                </thead>
                <tbody>
                    {% for sol in solicitudes_vac %}
                    <tr>
                        <td>
                            <strong>{{ sol.usuario.nombre }}</strong>
                            {% if sol.version > 1 %}
                                <span class="badge bg-warning text-dark ms-1">Modificada (v{{sol.version}})</span>
                            {% endif %}
                        </td>
                        <td>{{ sol.fecha_inicio.strftime('%d/%m/%Y') }}</td>
                        <td>{{ sol.fecha_fin.strftime('%d/%m/%Y') }}</td>
                        <td>{{ sol.dias_solicitados }}</td>
                        <td>
                            <form method="POST" action="{{ url_for('ausencias.responder_solicitud', id=sol.id, accion='aprobar') }}" style="display:inline;">
                                <button class="btn btn-sm btn-success"><i class="bi bi-check-lg"></i></button>
                            </form>
                            <form method="POST" action="{{ url_for('ausencias.responder_solicitud', id=sol.id, accion='rechazar') }}" style="display:inline;">
                                <button class="btn btn-sm btn-danger"><i class="bi bi-x-lg"></i></button>
                            </form>
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
        {% else %}
        <p class="text-muted">No hay vacaciones pendientes.</p>
        {% endif %}
    </div>
</div>

<div class="card">
    <div class="card-header bg-danger text-white">
        <h5 class="mb-0"><i class="bi bi-bandaid"></i> Bajas y Ausencias</h5>
    </div>
    <div class="card-body">
        {% if solicitudes_bajas %}
        <div class="table-responsive">
            <table class="table table-hover">
                <thead>
                    <tr>
                        <th>Empleado</th>
                        <th>Tipo</th>
                        <th>Desde</th>
                        <th>Hasta</th>
                        <th>Detalle</th>
                        <th>Acciones</th>
                    </tr>
                </thead>
                <tbody>
                    {% for sol in solicitudes_bajas %}
                    <tr>
                        <td>
                            <strong>{{ sol.usuario.nombre }}</strong>
                            {% if sol.version > 1 %}
                                <span class="badge bg-warning text-dark ms-1">v{{sol.version}}</span>
                            {% endif %}
                        </td>
                        <td>
                            {% if sol.tipo_ausencia %}
                                <strong>{{ sol.tipo_ausencia.nombre }}</strong>
                            {% else %}
                                Baja Genérica
                            {% endif %}
                        </td>
                        <td>{{ sol.fecha_inicio.strftime('%d/%m/%Y') }}</td>
                        <td>{{ sol.fecha_fin.strftime('%d/%m/%Y') }}</td>
                        <td><small>{{ sol.motivo }}</small></td>
                        <td>
                            <form method="POST" action="{{ url_for('ausencias.responder_baja', id=sol.id, accion='aprobar') }}" style="display:inline;">
                                <button class="btn btn-sm btn-success"><i class="bi bi-check-lg"></i></button>
                            </form>
                            <form method="POST" action="{{ url_for('ausencias.responder_baja', id=sol.id, accion='rechazar') }}" style="display:inline;">
                                <button class="btn btn-sm btn-danger"><i class="bi bi-x-lg"></i></button>
                            </form>
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
        {% else %}
        <p class="text-muted">No hay bajas pendientes.</p>
        {% endif %}
    </div>
</div>
{% endblock %}